<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper
	namespace="com.mycompany.viewport_mini_web.dao.ProductDao">

	<insert id="insert" parameterType="Product">
		<selectKey keyProperty="pid" order="BEFORE" resultType="int">
			select seq_pid.nextval from dual
		</selectKey>
		insert into product(
		pid, pname, pprice, pinfo, pdetail,
		pcategory,pattachoname,pattachsname,pattachtype,pattachdata, pshape, pdate
		) values(
		#{pid}, #{pname},
		#{pprice}, #{pinfo}, #{pdetail},
		#{pcategory},#{pattachoname},#{pattachsname},#{pattachtype},#{pattachdata}, #{pshape}, sysdate
		)
	</insert>

	<select id="selectCurrPid" parameterType="Product"
		resultType="int">
		select seq_pid.currval from dual
	</select>

	<select id="selectProductList" resultType="Product">
		select
		pid,pname,pprice,pinfo,pdetail,pcategory,pattachsname,pattachtype,pattachdata, pshape, pdate
		from product p

	</select>
	
	<select id="selectByPid" parameterType="int" resultType="Product">
		select	pid, pname, pprice, pinfo, pdetail, pcategory,pattachoname,pattachsname,pattachtype,pattachdata, pshape, pdate
		from product
		where pid=#{pid}
	</select>
	
	<select id="selectProductImg" parameterType="int" resultType="Product">
		select pattachdata from product where pid=#{pid}
	</select>

	<update id="update" parameterType="Product">
		update product set
		pname=#{pname},pprice=#{pprice},pinfo=#{pinfo},pdetail=#{pdetail},pcategory=#{pcategory}
		<if test="pattachoname != null">
				,
				pattachoname=#{pattachoname},
				pattachsname=#{pattachsname},
				pattachtype=#{pattachtype},
				pattachdata=#{pattachdata},
				pshape=#{pshape}
		</if>		
		where pid=#{pid}
	</update>

	<delete id="deleteByPid" parameterType="int">
		delete from product
		where
		pid=#{pid}
	</delete>
</mapper>



<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper
	namespace="com.mycompany.viewport_mini_web.dao.CartItemDao">
	<select id="findCartByUserIdAndProductId" parameterType="int" resultType="CartItem">
		select * from cart
		where cuid=#{cuid} and cpid=#{cpid}
	</select>

	<select id="findByCartIdAndProductId" parameterType="int"
		resultType="CartItem">
		select cid,cqty,cpid,cuid from cart
		where cpid=#{cpid} and cuid = #{cuid}
	</select>
	<insert id="createCartWithProduct" parameterType="int">
		<selectKey keyProperty="cid" order="BEFORE" resultType="int">
			select seq_cid.nextval from dual
		</selectKey>
		insert into cart (cid, cpid, cuid) values (#{cid}, #{cpid},
		#{cuid})
	</insert>
	<select id="findCartIdWithUserIdAndProductId"
		parameterType="int" resultType="int">
		select cid from cart
		where cpid=#{cpid} and cuid=#{cuid}
	</select>
	<select id="findCartByUserId" parameterType="int">
		select * from cart
		where cuid = #{cuid}
	</select>

	<update id="updateCqty" parameterType="int">
		update cart set
		cqty=#{cqty}, cpid=#{cpid}, cuid = #{cuid}
		where
		cpid=#{cpid} and cuid =
		#{cuid} and cid=#{cid}
	</update>
	<select id="selectAllCartItems" parameterType="int"
		resultType="CartItem">
		select cid,cqty,cpid,cuid
		from cart
		where
		cuid=#{cuid}
	</select>
	<delete id="removeCartItemByProductId" parameterType="int">
		delete from
		cart
		where
		cpid=#{cpid} and cuid=#{cuid}
	</delete>

	<delete id="removeCart" parameterType="int">
		delete from cart
		where cuid=#{cuid}
	</delete>
</mapper>
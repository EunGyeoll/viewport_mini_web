<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper
	namespace="com.mycompany.viewport_mini_web.dao.ProductDao">

	<insert id="insert" parameterType="Product">
		<selectKey keyProperty="pid" order="BEFORE" resultType="int">
			select seq_pid.nextval from dual
		</selectKey>
		insert into product(
		pid, pname, pprice, pinfo, pdetail,
		pcatno,pattachoname,pattachtype,pattachdata
		) values(
		#{pid}, #{pname},
		#{pprice}, #{pinfo}, #{pdetail},
		#{pcatno},#{pattachoname},#{pattachtype},#{pattachdata}
		)
	</insert>

	<select id="selectCurrPid" parameterType="Product"
		resultType="int">
		select seq_pid.currval from dual
	</select>

	<select id="selectProductList" resultType="Product">
		select
		pid,pname,pprice,pinfo,pdetail,pcatno,pattachoname,pattachtype,p.pattachdata
		from product p

	</select>

	<update id="update" parameterType="Product">
		update product set
		pname=#{pname},pprice=#{pprice},pinfo=#{pinfo},pdetail=#{pdetail},pcatno=#{pcatno}
		<if test="pattachoname != null">
				,
				pattachoname=#{pattachoname},
				pattachtype=#{pattachtype},
				pattachdata=#{pattachdata}
		</if>		
		where pid=#{pid}
	</update>

	<delete id="deleteByPid" parameterType="int">
		delete from product
		where
		pid=#{pid}
	</delete>
</mapper>


